<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Leitor de Updates â€” Betgram</title>
  <style>
    body {
      background: #0b1324;
      color: #fff;
      font-family: monospace;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 180px;
      background: #111827;
      color: #00ff90;
      border: 2px solid gold;
      border-radius: 6px;
      padding: 10px;
      font-size: 13px;
      white-space: pre;
    }
    .btns {
      display: flex;
      gap: 10px;
      margin: 10px 0;
    }
    button {
      padding: 10px 18px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      color: #fff;
      font-family: monospace;
    }
    #btnProcessar { background: #22c55e; }
    #btnAbrirBot { background: #2563eb; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #334155;
      padding: 8px;
      text-align: left;
    }
    th {
      background: #1e293b;
      color: gold;
    }
    tr:nth-child(even) {
      background: #111827;
    }
    tr:nth-child(odd) {
      background: #0f172a;
    }
    td button.copy {
      background: #444;
      color: #fff;
      border: none;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
    }
    td button.copy:hover {
      background: #666;
    }
  </style>
</head>
<body>
  <h2>ğŸ“‹ Leitor de Updates Telegram â€” Betgram</h2>
  <p>Cole abaixo o JSON retornado pelo <code>getUpdates</code> ou clique em â€œIr para botâ€ para abrir direto a API:</p>
  
  <div class="btns">
    <button id="btnAbrirBot">ğŸ”— Ir para bot</button>
    <button id="btnProcessar">ğŸ” Processar JSON</button>
  </div>

  <textarea id="inputJson" placeholder='Cole aqui o {"ok":true,"result":[...]}'></textarea>

  <table id="tabela">
    <thead>
      <tr>
        <th>ğŸ†” ID</th>
        <th>ğŸ‘¤ Remetente</th>
        <th>ğŸ’¬ Texto / Legenda</th>
        <th>ğŸ•’ HorÃ¡rio</th>
        <th>ğŸ’­ Chat</th>
        <th>ğŸ“‹ Copiar</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const token = "8389689778:AAFxqYCPj-w2M5hWhRxuXvRjhvc8zLw7Djw";

    document.getElementById("btnAbrirBot").onclick = () => {
      const url = `https://api.telegram.org/bot${token}/getUpdates`;
      window.open(url, "_blank");
    };

    function timestampToDate(ts) {
      if (!ts) return "";
      const d = new Date(ts * 1000);
      return d.toLocaleString("pt-BR", { hour12: false });
    }

    document.getElementById("btnProcessar").onclick = () => {
      const text = document.getElementById("inputJson").value.trim();
      if (!text) return alert("Cole o JSON do getUpdates primeiro!");
      let data;
      try { data = JSON.parse(text); } 
      catch (e) { return alert("JSON invÃ¡lido!"); }

      const tbody = document.querySelector("#tabela tbody");
      tbody.innerHTML = "";

      data.result?.forEach(update => {
        const msg = update.message || update.my_chat_member?.chat;
        if (!msg || !update.message) return;

        const id = update.message.message_id || "-";
        const from = update.message.from?.first_name || "Desconhecido";
        const text = update.message.text || update.message.caption || "(sem texto)";
        const date = timestampToDate(update.message.date);
        const chat = update.message.chat?.title || update.message.chat?.id || "privado";

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${id}</td>
          <td>${from}</td>
          <td>${text}</td>
          <td>${date}</td>
          <td>${chat}</td>
          <td><button class="copy" data-id="${id}">Copiar</button></td>
        `;
        tbody.appendChild(tr);
      });

      // BotÃ£o copiar ID
      document.querySelectorAll("button.copy").forEach(btn => {
        btn.onclick = () => {
          navigator.clipboard.writeText(btn.dataset.id);
          btn.textContent = "âœ… Copiado!";
          setTimeout(() => btn.textContent = "Copiar", 1500);
        };
      });
    };
  </script>
</body>
</html>
