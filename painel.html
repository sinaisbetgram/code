<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel Betgram â€” Sinais com ID</title>
<style>
  body {
    background: #0b1324;
    color: #fff;
    font-family: monospace;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  #painel {
    background: rgba(11,19,36,0.97);
    border: 2px solid gold;
    border-radius: 12px;
    width: 280px;
    padding: 15px;
    box-shadow: 0 0 15px rgba(255,215,0,0.4);
    text-align: center;
  }
  input, button {
    width: 100%;
    margin-bottom: 8px;
    border: none;
    border-radius: 6px;
    padding: 8px;
    font-weight: bold;
    cursor: pointer;
  }
  input[type="file"] {
    background: #111827;
    border: 1px solid #334155;
    color: white;
  }
  button.risco { background: #facc15; color: #111; box-shadow: 0 0 6px rgba(250,204,21,0.6); }
  button.conf { background: #22c55e; color: #fff; box-shadow: 0 0 6px rgba(34,197,94,0.6); }
  button.alta { background: #3b82f6; color: #fff; box-shadow: 0 0 6px rgba(59,130,246,0.6); }
  button.ver { background: #ef4444; color: #fff; box-shadow: 0 0 6px rgba(239,68,68,0.6); }
  button.ok { background: #22c55e; color: white; width: 48%; }
  button.erro { background: #ef4444; color: white; width: 48%; }
  #status { font-size: 12px; margin-top: 6px; color: #9ca3af; }
</style>
</head>
<body>

<div id="painel">
  <h3>ğŸ“¤ Enviar Aposta</h3>
  <input type="file" id="uploadImg" accept="image/*">
  <button class="risco" id="btn05">âš ï¸ 0,5% Risco</button>
  <button class="conf" id="btn1">ğŸ’¡ 1% ConfianÃ§a</button>
  <button class="alta" id="btn2">ğŸ”¥ 2% Alta</button>
  <button class="ver" id="btnVer">ğŸ” Ver Aposta</button>

  <p id="status">ğŸ•“ Aguardando envio...</p>
  <hr style="border:1px solid #334155;margin:8px 0;">
  <label style="font-size:13px;">ğŸ§¾ ID da mensagem:</label>
  <input id="msgId" type="number" placeholder="Ex: 266">
  <div style="display:flex;justify-content:space-between;">
    <button class="ok" id="ganhei">âœ… Ganhei</button>
    <button class="erro" id="perdi">âŒ Perdi</button>
  </div>
</div>

<script>
const token = "8389689778:AAFxqYCPj-w2M5hWhRxuXvRjhvc8zLw7Djw";
const chatId = "-1003073897767";
let sinais = JSON.parse(localStorage.getItem("sinaisBetgram") || "[]");

function salvar(id, caption) {
  sinais.push({ id, caption, data: new Date().toLocaleString("pt-BR") });
  localStorage.setItem("sinaisBetgram", JSON.stringify(sinais));
}

async function enviarImagem(textoBase) {
  const input = document.getElementById("uploadImg");
  const status = document.getElementById("status");
  const msgIdInput = document.getElementById("msgId");
  const arquivo = input.files[0];

  if (!arquivo) {
    alert("ğŸ“ Escolha uma imagem antes de enviar!");
    return;
  }

  status.textContent = "â³ Enviando...";
  status.style.color = "#9ca3af";

  try {
    // Envia primeiro a imagem com legenda temporÃ¡ria
    const form = new FormData();
    form.append("chat_id", chatId);
    form.append("photo", arquivo);
    form.append("caption", "â³ Enviando...");
    form.append("parse_mode", "Markdown");

    const resp = await fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
      method: "POST",
      body: form
    });
    const data = await resp.json();

    if (data.ok) {
      const msgId = data.result.message_id;
      msgIdInput.value = msgId;

      // Cria legenda final com o ID incluso
      const legendaFinal = `ğŸ“¢ *Sinais BetGram â€” #${msgId}*\n${textoBase}`;
      
      // Edita a legenda da imagem para incluir o ID
      await fetch(`https://api.telegram.org/bot${token}/editMessageCaption`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: chatId,
          message_id: msgId,
          caption: legendaFinal,
          parse_mode: "Markdown"
        })
      });

      salvar(msgId, textoBase);
      status.textContent = `âœ… Enviado com sucesso! (ID ${msgId})`;
      status.style.color = "#22c55e";
    } else {
      status.textContent = "âŒ Erro: " + data.description;
      status.style.color = "#ef4444";
    }
  } catch (e) {
    status.textContent = "âš ï¸ Falha: " + e.message;
    status.style.color = "#ef4444";
  }
}

async function editarLegenda(id, novaLegenda) {
  const status = document.getElementById("status");
  if (!id) return alert("Digite o ID da mensagem!");

  status.textContent = "âœï¸ Editando...";
  try {
    const legenda = `ğŸ“¢ *Sinais BetGram â€” #${id}*\n${novaLegenda}`;
    const resp = await fetch(`https://api.telegram.org/bot${token}/editMessageCaption`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: chatId,
        message_id: parseInt(id),
        caption: legenda,
        parse_mode: "Markdown"
      })
    });
    const data = await resp.json();
    if (data.ok) {
      status.textContent = "âœ… Editado com sucesso!";
      status.style.color = "#22c55e";
    } else {
      status.textContent = "âŒ Erro ao editar: " + data.description;
      status.style.color = "#ef4444";
    }
  } catch (err) {
    status.textContent = "âš ï¸ Erro: " + err.message;
    status.style.color = "#ef4444";
  }
}

// === BOTÃ•ES ===
document.getElementById("btn05").onclick = () =>
  enviarImagem("âš ï¸ *Entrada leve â€” 0,5% da banca.*\nOdd de valor, mas com risco.");

document.getElementById("btn1").onclick = () =>
  enviarImagem("ğŸ’¡ *Entrada padrÃ£o â€” 1% da banca.*\nConfianÃ§a moderada.");

document.getElementById("btn2").onclick = () =>
  enviarImagem("ğŸ”¥ *Entrada forte â€” 2% da banca.*\nAlta confianÃ§a!");

document.getElementById("btnVer").onclick = () =>
  window.open("https://www.betano.bet.br/myaccount/bethistory/open", "_blank");

document.getElementById("ganhei").onclick = () =>
  editarLegenda(document.getElementById("msgId").value, "âœ… *Aposta VENCIDA!* ğŸŸ¢");

document.getElementById("perdi").onclick = () =>
  editarLegenda(document.getElementById("msgId").value, "âŒ *Aposta PERDIDA!* ğŸ”´");
</script>

</body>
</html>
